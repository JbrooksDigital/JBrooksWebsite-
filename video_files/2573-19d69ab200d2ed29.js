"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2573],{22573:function(e,t,a){a.d(t,{Z:function(){return q}});var r,i,n=a(5452),l=a(46330),s=a(7323),d=a(87656),o=a(1654),u=a(53705),c=a(91506),g=a(18825),v=a(49660),h=a(62938),p=a(71006),f=a(82490),m=a(27940),y=a(59325),x=a(64312);let P=e=>["feed",null==e?void 0:e.variant,null==e?void 0:e.timeRange,null==e?void 0:e.taskTypeFilters,null==e?void 0:e.operationFilters,null==e?void 0:e.presetId,null==e?void 0:e.flags];var w=a(30697),R=a(23651),H=a(47993),T=a(15767),F=a(4048),S=a(34118);(r=i||(i={})).UserQuery="userQuery",r.GenerationQuery="generationQuery",r.Home="home",r.Images="images",r.Videos="videos",r.Top="top",r.Featured="featured",r.Recent="recent",r.Library="library",r.Activity="activity";let b=()=>{let{searchType:e}=(0,S.v)(!1),t=(0,l.usePathname)();return e===T.n8.User?"userQuery":e===T.n8.Generation?"generationQuery":t.startsWith((0,F._e)())?"images":t.startsWith((0,F.gm)())?"videos":t.startsWith((0,F.BL)())?"top":t.startsWith((0,F.hT)())?"featured":t.startsWith((0,F.dw)())?"recent":t.startsWith((0,F.rS)())?"home":t.startsWith((0,F.sp)())?"library":t.startsWith((0,F.OV)())?"activity":null};var M=a(87357),j=a(39826),Q=a(96887),_=a(74014),W=a(86171),Z=a(66980);let k=_.zB.day;function X(){var e;let t=(0,Z.Z)(),a=(0,l.useSearchParams)(),r=null!==(e=a.get("t"))&&void 0!==e?e:void 0,i=Object.values(_.zB),s=i.includes(r)?r:k,o=(0,d.Z)(),u=Object.fromEntries(i.map(e=>[e,o.formatMessage(U["".concat(e,"TimeRange")])]));return(0,n.jsx)("div",{className:"flex",children:(0,n.jsxs)(W.Ph,{onValueChange:e=>{if(e){let r=new URLSearchParams(a);r.set("t",e),t.push("".concat(window.location.pathname,"?").concat(r.toString()))}},value:s,children:[(0,n.jsxs)(j.xz,{className:"flex items-center gap-1.5 text-token-text-secondary",children:[(0,n.jsx)(W.ki,{children:u[s]}),(0,n.jsx)(j.JO,{asChild:!0,children:(0,n.jsx)(Q.Z,{className:"h-4 w-4"})})]}),(0,n.jsx)(W.Bw,{children:Object.values(_.zB).map(e=>(0,n.jsx)(W.Ql,{value:e,children:u[e]},e))})]})})}let U=(0,o.vU)({hourTimeRange:{id:"topFeedTimeRangeSelect.hourTimeRange",description:"Hour time range option",defaultMessage:"Hour"},dayTimeRange:{id:"topFeedTimeRangeSelect.dayTimeRange",description:"Day time range option",defaultMessage:"Day"},weekTimeRange:{id:"topFeedTimeRangeSelect.weekTimeRange",description:"Week time range option",defaultMessage:"Week"},monthTimeRange:{id:"topFeedTimeRangeSelect.monthTimeRange",description:"Month time range option",defaultMessage:"Month"},yearTimeRange:{id:"topFeedTimeRangeSelect.yearTimeRange",description:"Year time range option",defaultMessage:"Year"},all_timeTimeRange:{id:"topFeedTimeRangeSelect.all_timeTimeRange",description:"'All time' time range option",defaultMessage:"All time"}});function q(e){let{variant:t}=e;(0,H.f)("feed",{variant:t});let a=b(),r=(0,l.useSearchParams)(),i=(0,d.Z)(),o=v.Z.useActions(),u=i.formatMessage(function(e){switch(e){case x.X.featured:return I.featuredHeader;case x.X.home:return I.exploreHeader;case x.X.images:return I.imagesHeader;case x.X.videos:return I.videosHeader;case x.X.top:return I.topHeader;case x.X.recent:return I.recentHeader;case x.X.preset:return I.exploreHeader;case x.X.basic:return I.basicHeader;default:return(0,w.R)(e),I.recentHeader}}(t));return(0,s.useEffect)(()=>{let e="".concat(window.location.pathname).concat(window.location.search);return e.startsWith("/explore")&&o.setRootPage({title:u,href:e}),()=>{}},[o,u,a,r]),(0,n.jsx)(N,{variant:t,title:u})}function N(e){var t,a,r,i,d,o,v,w,H,T,F,S;let{variant:b,title:j}=e,Q=(0,R.cn)(),_=(0,R.Ke)(),W=(0,l.useSearchParams)(),[Z,k]=(0,s.useState)(W);(0,s.useEffect)(()=>{window.location.pathname.startsWith("/explore")&&k(W)},[W]);let U=null!==(a=Z.get("t"))&&void 0!==a?a:void 0,q=Z.get("source"),N=Z.get("q"),I=Z.get("pid"),G=null!==(r=null===(t=Z.get("flags"))||void 0===t?void 0:t.split(","))&&void 0!==r?r:[],E=null!==(i=Q||_?q:null)&&void 0!==i?i:null,O=null!==(d=Q?N:void 0)&&void 0!==d?d:void 0,A=null!==(o=Q?Z.getAll("t"):void 0)&&void 0!==o?o:void 0,C=null!==(v=Q?Z.getAll("c"):void 0)&&void 0!==v?v:void 0,B=null!==(w=Q?"true"===Z.get("is_showable"):void 0)&&void 0!==w?w:void 0,K=null!==(H=Q?"true"===Z.get("is_hidden_from_feed"):void 0)&&void 0!==H?H:void 0,{taskTypeFilters:L}=(0,g.Fp)(),{operationFilters:V}=(0,g.eg)(),z=_&&null!==(T=Z.get("curator"))&&void 0!==T?T:void 0,{status:D,data:J,error:Y,isFetchingNextPage:$,fetchNextPage:ee,hasNextPage:et}=(F={variant:b,timeRange:null!=U?U:void 0,taskTypeFilters:L,operationFilters:V,flags:G,presetId:null!=I?I:void 0},S=null!=E?{adminSource:E,q:O,t:A,c:C,isShowable:B,isHiddenFromFeed:K,curator:z}:void 0,(0,m.useInfiniteQuery)({queryKey:P(F),queryFn:async e=>{if((null==F?void 0:F.variant)===x.X.preset&&(null==F?void 0:F.presetId)){let t=await y.Z.searchPreset(F.presetId,e.pageParam||null);return{...t,data:t.data.map(e=>e.generation)}}return(null==S?void 0:S.adminSource)==="favorites"||(null==S?void 0:S.adminSource)==="recent"||(null==S?void 0:S.adminSource)==="best"||(null==S?void 0:S.adminSource)==="featured"?await y.Z.adminGetFeed({source:null==S?void 0:S.adminSource,after:e.pageParam,q:null==S?void 0:S.q,t:null==S?void 0:S.t,c:null==S?void 0:S.c,isShowable:null==S?void 0:S.isShowable,isHiddenFromFeed:null==S?void 0:S.isHiddenFromFeed,curator:null==S?void 0:S.curator}):await y.Z.getFeed({variant:null==F?void 0:F.variant,after:e.pageParam,time_range:null==F?void 0:F.timeRange,taskTypeFilters:null==F?void 0:F.taskTypeFilters,operationFilters:null==F?void 0:F.operationFilters,flags:null==F?void 0:F.flags})},refetchOnMount:!1,initialPageParam:"",getNextPageParam:e=>(null==e?void 0:e.has_more)?e.last_id:null})),ea=(0,s.useMemo)(()=>J?J.pages.flatMap(e=>{var t;return null!==(t=null==e?void 0:e.data)&&void 0!==t?t:[]}).filter((e,t,a)=>t===a.findIndex(t=>t.id===e.id)):[],[J]);return(0,u.X)({allGenerations:ea,hasNextPage:et,isFetchingNextPage:$,fetchNextPage:ee}),(0,n.jsxs)(M.Z,{title:j,subtitle:b===x.X.top&&(0,n.jsx)(X,{}),children:[b===x.X.preset&&I&&(0,n.jsx)(f.a,{children:(0,n.jsx)(p.J,{presetId:I,actions:[p.R.Manage,p.R.Use]})}),(0,n.jsx)(c.Z,{generations:ea,fetchNextPage:ee,hasNextPage:et,isFetchingNextPage:$,status:D,error:Y,emptyPlaceholder:L.length>0||V.length>0?(0,n.jsx)(h.Fm,{}):null})]})}let I=(0,o.vU)({featuredHeader:{id:"feed.featuredHeader",description:"Page header for the featured feed page",defaultMessage:"Featured"},recentHeader:{id:"feed.recentHeader",description:"Page header for the recent feed page",defaultMessage:"Recent"},topHeader:{id:"feed.topHeader",description:"Page header for the top feed page",defaultMessage:"Top"},exploreHeader:{id:"feed.exploreHeader",description:"Page header for the explore feed page",defaultMessage:"Explore"},imagesHeader:{id:"feed.imagesHeader",description:"Page header for the images feed page",defaultMessage:"Images"},videosHeader:{id:"feed.videosHeader",description:"Page header for the videos feed page",defaultMessage:"Videos"},presetHeader:{id:"feed.presetHeader",description:"Page header for the preset feed page",defaultMessage:"Preset"},basicHeader:{id:"feed.basicHeader",description:"Page header for the ranked feed page",defaultMessage:"Explore"}})},15767:function(e,t,a){a.d(t,{KG:function(){return c},n8:function(){return i},nC:function(){return g}});var r,i,n=a(79362),l=a(27940),s=a(59325),d=a(53048);(r=i||(i={})).User="user",r.Generation="generation",r.Text="text";let o=["search","generations"],u=(e,t)=>[...o,{query:e,scope:t}],c=(e,t)=>{let a=("disabled-auth-fake-user-id"===e||e.startsWith("user-"))&&"public"===t,r=e.startsWith("gen_")&&"public"===t;return a?"user":r?"generation":"text"};function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"library",a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=(0,n.useQueryClient)(),o=null!=r?r:c(e,t);return(0,l.useInfiniteQuery)({queryKey:u(e,t),queryFn:async a=>"user"===o?await s.Z.searchUser(e,a.pageParam||null):"generation"===o?await s.Z.searchGenerations(e.split(","),a.pageParam||null):await s.Z.searchText(e,t,a.pageParam||null),refetchOnMount:"always",initialPageParam:"",getNextPageParam:e=>(null==e?void 0:e.has_more)?e.last_id:null,enabled:a,select:e=>({...e,pages:e.pages.map(e=>({...e,data:e.data.map(e=>{var t;return{...e,generation:null!==(t=i.getQueryData((0,d.NX)(e.generation.id)))&&void 0!==t?t:e.generation}})}))})})}},34118:function(e,t,a){a.d(t,{v:function(){return d}});var r=a(46330),i=a(49660),n=a(15767);let l=()=>{var e;let t=i.Z.useState(e=>e.rootPage),a=null;return(null==t?void 0:t.href)&&(null==t?void 0:null===(e=t.href)||void 0===e?void 0:e.startsWith("/library"))&&(a=new URL(t.href,window.location.origin).searchParams.get("query")),{searchQuery:a}},s=()=>{var e;let t=i.Z.useState(e=>e.rootPage),a=null,r=null;if((null==t?void 0:t.href)&&(null==t?void 0:null===(e=t.href)||void 0===e?void 0:e.startsWith("/explore"))){let e=new URL(t.href,window.location.origin);a=e.searchParams.get("query"),r=e.searchParams.get("user")}return{searchQuery:a,usernameSearchQuery:r}},d=function(){var e,t;let a=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{searchQuery:i}=l(),{searchQuery:d,usernameSearchQuery:o}=s(),u=(0,r.useSearchParams)(),c=null!==(e=u.get("query"))&&void 0!==e?e:"",g=null!==(t=u.get("user"))&&void 0!==t?t:"",v=a?c||i||d||"":c,h=a?g||o||"":g,p=v.trim().length>0,f=h.trim().length>0,m=f?n.n8.User:p?(0,n.KG)(v,"public"):null,y=p&&m===n.n8.Text,x=f||p&&m===n.n8.User,P=p&&m===n.n8.Generation;return{searchQuery:h||v,isQuery:f||p,searchType:m,isValidQuery:y||x||P}}}}]);
//# sourceMappingURL=2573-19d69ab200d2ed29.js.map